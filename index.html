<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgendAI - Sistema de Agendamento para Barbearias</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        body { font-family: 'Poppins', sans-serif; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <header class="bg-white/80 backdrop-blur-md fixed top-0 left-0 right-0 z-50 shadow-sm">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-2xl font-bold tracking-wider">Agend<span class="text-indigo-600">AI</span></h1>
            <nav class="hidden md:flex items-center space-x-8">
                <a href="#" class="text-sm font-semibold hover:text-indigo-600">Início</a>
                <a href="#" class="text-sm font-semibold hover:text-indigo-600">Recursos</a>
                <a href="#" class="text-sm font-semibold hover:text-indigo-600">Contato</a>
            </nav>
            <div class="hidden md:flex items-center space-x-2">
                 <a href="#login-modal" id="login-btn-desktop" class="text-sm font-semibold bg-slate-100 hover:bg-slate-200 px-4 py-2 rounded-lg">Entrar</a>
                <a href="#login-modal" id="signup-btn-desktop" class="text-sm font-semibold bg-indigo-600 text-white hover:bg-indigo-700 px-4 py-2 rounded-lg">Criar Conta Grátis</a>
            </div>
            <div class="md:hidden">
                <button id="mobile-menu-button" class="text-slate-800 focus:outline-none">
                    <i data-feather="menu" class="w-6 h-6"></i>
                </button>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden">
            <div class="px-6 pt-2 pb-4 space-y-2 border-t border-slate-200">
                <a href="#" class="block text-sm font-semibold hover:text-indigo-600 py-2">Início</a>
                <a href="#" class="block text-sm font-semibold hover:text-indigo-600 py-2">Recursos</a>
                <a href="#" class="block text-sm font-semibold hover:text-indigo-600 py-2">Contato</a>
                <div class="border-t border-slate-200 pt-4 space-y-3">
                     <a href="#login-modal" id="login-btn-mobile" class="block text-center text-sm font-semibold bg-slate-100 hover:bg-slate-200 px-4 py-2 rounded-lg">Entrar</a>
                    <a href="#login-modal" id="signup-btn-mobile" class="block text-center text-sm font-semibold bg-indigo-600 text-white hover:bg-indigo-700 px-4 py-2 rounded-lg">Criar Conta Grátis</a>
                </div>
            </div>
        </div>
    </header>

    <main class="pt-32 pb-16">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-4xl md:text-6xl font-bold leading-tight">
                Otimize sua Barbearia. <br class="hidden md:block">
                <span class="text-indigo-600">Nunca mais perca um cliente.</span>
            </h2>
            <p class="mt-6 text-lg text-slate-600 max-w-2xl mx-auto">
                Agenda online, controle financeiro e lembretes automáticos via WhatsApp. Tudo que você precisa para focar no que faz de melhor: cortes incríveis.
            </p>
            <div class="mt-8 flex justify-center flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4">
                <a href="#login-modal" id="cta-btn" class="bg-indigo-600 text-white font-semibold px-8 py-3 rounded-lg shadow-lg hover:bg-indigo-700 transition-transform transform hover:scale-105">
                    Começar Teste Grátis de 14 Dias
                </a>
            </div>
        </div>
    </main>

    <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
        <div id="modal-content" class="bg-white rounded-xl shadow-2xl p-8 max-w-sm w-full relative">
            </div>
    </div>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, Timestamp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        const firebaseConfig = {
          apiKey: "AIzaSyAkIUtakV64F2SYjvJylTGlw8-vTfXc3Fk",
          authDomain: "agendabarber-3fe30.firebaseapp.com",
          projectId: "agendabarber-3fe30",
          storageBucket: "agendabarber-3fe30.appspot.com",
          messagingSenderId: "1098037500040",
          appId: "1:1098037500040:web:62c82a203a3276ffaa273d"
        };
        
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Se o usuário já estiver logado, redireciona para o dashboard
        onAuthStateChanged(auth, (user) => {
            if (user) { 
                window.location.href = 'dashboard.html'; 
            }
        });

        // Lógica do Menu Mobile
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        const modal = document.getElementById('login-modal');
        const modalContent = document.getElementById('modal-content');

        const buttonsToOpenModal = [
            document.getElementById('login-btn-desktop'),
            document.getElementById('signup-btn-desktop'),
            document.getElementById('login-btn-mobile'),
            document.getElementById('signup-btn-mobile'),
            document.getElementById('cta-btn')
        ];

        const closeModal = () => {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        };

        const openModal = (type) => {
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            modalContent.innerHTML = `<button id="close-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-800"><i data-feather="x" class="w-6 h-6"></i></button>`;
            
            if (type === 'login') {
                modalContent.innerHTML += `<h2 class="text-2xl font-bold text-center mb-6">Acessar Painel</h2><form id="login-form" class="space-y-4"><div><label for="login-email" class="block text-sm font-medium">Email</label><input type="email" id="login-email" required class="w-full p-2 border rounded-md mt-1"></div><div><label for="login-password" class="block text-sm font-medium">Senha</label><input type="password" id="login-password" required class="w-full p-2 border rounded-md mt-1"></div><button type="submit" class="w-full bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700">Entrar</button></form><p class="text-center text-sm mt-4">Não tem uma conta? <a href="#" id="switch-to-signup" class="text-indigo-600 font-semibold">Crie agora</a></p>`;
                document.getElementById('login-form').addEventListener('submit', handleLogin);
                document.getElementById('switch-to-signup').addEventListener('click', (e) => { e.preventDefault(); openModal('signup'); });
            } else {
                modalContent.innerHTML += `<h2 class="text-2xl font-bold text-center mb-6">Crie sua Conta Grátis</h2><form id="signup-form" class="space-y-4"><div><label for="signup-shop" class="block text-sm font-medium">Nome da Barbearia</label><input type="text" id="signup-shop" required class="w-full p-2 border rounded-md mt-1"></div><div><label for="signup-email" class="block text-sm font-medium">Email</label><input type="email" id="signup-email" required class="w-full p-2 border rounded-md mt-1"></div><div><label for="signup-password" class="block text-sm font-medium">Senha</label><input type="password" id="signup-password" required class="w-full p-2 border rounded-md mt-1"></div><button type="submit" class="w-full bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-700">Criar Conta</button></form><p class="text-center text-sm mt-4">Já tem uma conta? <a href="#" id="switch-to-login" class="text-indigo-600 font-semibold">Faça login</a></p>`;
                document.getElementById('signup-form').addEventListener('submit', handleSignup);
                document.getElementById('switch-to-login').addEventListener('click', (e) => { e.preventDefault(); openModal('login'); });
            }
            feather.replace();
            document.getElementById('close-modal-btn').addEventListener('click', closeModal);
        };

        buttonsToOpenModal.forEach(btn => {
            if (btn) {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (mobileMenu) mobileMenu.classList.add('hidden');
                    const type = btn.id.includes('login') ? 'login' : 'signup';
                    openModal(type);
                });
            }
        });
        
        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });

        const handleSignup = (e) => {
            e.preventDefault();
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            const barbershopName = document.getElementById('signup-shop').value;
            createUserWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    return setDoc(doc(db, "users", user.uid), {
                        barbershopName: barbershopName,
                        email: email,
                        createdAt: Timestamp.now()
                    });
                })
                .catch((error) => alert(error.message));
        };

        const handleLogin = (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            signInWithEmailAndPassword(auth, email, password)
                .catch((error) => alert("Email ou senha inválidos."));
        };

        feather.replace();
    </script>
</body>
</html>
